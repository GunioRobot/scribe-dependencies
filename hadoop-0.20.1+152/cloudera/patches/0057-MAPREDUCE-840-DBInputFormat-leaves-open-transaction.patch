From 4de0b29c1996d1bdd64cbb3e66ba38091ab519d4 Mon Sep 17 00:00:00 2001
From: Aaron Kimball <aaron@cloudera.com>
Date: Thu, 13 Aug 2009 15:40:16 -0700
Subject: [PATCH] MAPREDUCE-840: DBInputFormat leaves open transaction

---
 .../apache/hadoop/mapred/lib/db/DBInputFormat.java |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/src/mapred/org/apache/hadoop/mapred/lib/db/DBInputFormat.java b/src/mapred/org/apache/hadoop/mapred/lib/db/DBInputFormat.java
index f74c16d..ce1469e 100644
--- a/src/mapred/org/apache/hadoop/mapred/lib/db/DBInputFormat.java
+++ b/src/mapred/org/apache/hadoop/mapred/lib/db/DBInputFormat.java
@@ -393,6 +393,7 @@ public class DBInputFormat<T  extends DBWritable>
         splits[i] = split;
       }
 
+      connection.commit();
       return splits;
     } catch (SQLException e) {
       throw new IOException(e.getMessage());
-- 
1.6.0.4

