From 28778e6442ac75d429ecf364e845dbfa65fc8f18 Mon Sep 17 00:00:00 2001
From: Aaron Kimball <aaron@cloudera.com>
Date: Mon, 14 Sep 2009 19:54:21 -0700
Subject: [PATCH] MAPREDUCE-840: DBInputFormat leaves open transaction
 (reapplied after HADOOP-4687)

---
 .../hadoop/mapreduce/lib/db/DBInputFormat.java     |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/src/mapred/org/apache/hadoop/mapreduce/lib/db/DBInputFormat.java b/src/mapred/org/apache/hadoop/mapreduce/lib/db/DBInputFormat.java
index 4e8b037..0032ce1 100644
--- a/src/mapred/org/apache/hadoop/mapreduce/lib/db/DBInputFormat.java
+++ b/src/mapred/org/apache/hadoop/mapreduce/lib/db/DBInputFormat.java
@@ -248,6 +248,7 @@ public class DBInputFormat<T extends DBWritable>
         splits.add(split);
       }
 
+      connection.commit();
       return splits;
     } catch (SQLException e) {
       try {
-- 
1.6.0.4

